<!DOCTYPE html>
<html>

<head>
    <title> Time series prediction | VARNN </title>
    <link rel="icon" href="static/images/logo-design.png">
    <script src="{{ url_for('static', filename='js/parameters.js') }}"></script>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/footer.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="eleven">
        <h1>
            <img src="static/images/logo-design-remove.png" id="logo" title="Where Time Reveals its Secrets">
            <script>
                document.getElementById('logo').addEventListener('click', function () {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            </script>
            <span id="logo-text">Time.Sync</span>
            <div id="search-box">
                <i class="fas fa-search" id="search-icon"></i>
                <input type="text" id="search-input" placeholder="Search...">
            </div>
            <script>
                document.getElementById('search-input').addEventListener('keypress', function (event) {
                    if (event.key === 'Enter') {
                        window.open('https://www.google.com/search?q=' + this.value, '_blank');
                        this.value = '';
                    }
                });
            </script>

            <div><a href="http://example.com" target="_blank" class="my-link-page">Resoures</a></div>
            <div><a href="http://example.com" target="_blank" class="my-link-page">Documents</a></div>
            <div><a href="http://example.com" target="_blank" class="my-link-page">Report</a></div>
            <label class="switch">
                <span class="sun"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <g fill="#ffd43b">
                            <circle r="5" cy="12" cx="12"></circle>
                            <path
                                d="m21 13h-1a1 1 0 0 1 0-2h1a1 1 0 0 1 0 2zm-17 0h-1a1 1 0 0 1 0-2h1a1 1 0 0 1 0 2zm13.66-5.66a1 1 0 0 1 -.66-.29 1 1 0 0 1 0-1.41l.71-.71a1 1 0 1 1 1.41 1.41l-.71.71a1 1 0 0 1 -.75.29zm-12.02 12.02a1 1 0 0 1 -.71-.29 1 1 0 0 1 0-1.41l.71-.66a1 1 0 0 1 1.41 1.41l-.71.71a1 1 0 0 1 -.7.24zm6.36-14.36a1 1 0 0 1 -1-1v-1a1 1 0 0 1 2 0v1a1 1 0 0 1 -1 1zm0 17a1 1 0 0 1 -1-1v-1a1 1 0 0 1 2 0v1a1 1 0 0 1 -1 1zm-5.66-14.66a1 1 0 0 1 -.7-.29l-.71-.71a1 1 0 0 1 1.41-1.41l.71.71a1 1 0 0 1 0 1.41 1 1 0 0 1 -.71.29zm12.02 12.02a1 1 0 0 1 -.7-.29l-.66-.71a1 1 0 0 1 1.36-1.36l.71.71a1 1 0 0 1 0 1.41 1 1 0 0 1 -.71.24z">
                            </path>
                        </g>
                    </svg></span>
                <span class="moon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                        <path
                            d="m223.5 32c-123.5 0-223.5 100.3-223.5 224s100 224 223.5 224c60.6 0 115.5-24.2 155.8-63.4 5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6-96.9 0-175.5-78.8-175.5-176 0-65.8 36-123.1 89.3-153.3 6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z">
                        </path>
                    </svg></span>
                <input type="checkbox" class="input">
                <span class="slider"></span>
                <script>
                    window.onload = function () {
                        var checkbox = document.querySelector('.input');
                        var body = document.querySelector('body'); // Select the body
                        var h2Elements = document.querySelectorAll('h2'); // Select all h2 elements
                        var element = document.querySelector('.eleven');
                        var textElements = element.querySelectorAll('h1, p, svg'); // Select all h1, p, and svg elements within .eleven
                        var menuIcon = document.querySelector('#menu-icon'); // Select the menu icon
                        var links = document.querySelectorAll('.my-link-page'); // Select the links
                        var logoText = document.querySelector('#logo-text'); // Select the logo text

                        checkbox.addEventListener('change', function () {
                            if (this.checked) {
                                body.style.backgroundColor = 'black';
                                h2Elements.forEach(function (el) {
                                    el.style.color = 'white';
                                });
                                element.style.backgroundColor = 'black';
                                textElements.forEach(function (el) {
                                    el.style.color = 'white';
                                });
                                menuIcon.style.color = 'white';
                                links.forEach(function (link) {
                                    link.style.color = 'white';
                                });
                                logoText.style.color = '#bfc07c';

                            } else {
                                body.style.backgroundColor = '';
                                h2Elements.forEach(function (el) {
                                    el.style.color = '';
                                });
                                element.style.backgroundColor = '';
                                textElements.forEach(function (el) {
                                    el.style.color = '';
                                });
                                menuIcon.style.color = '';
                                links.forEach(function (link) {
                                    link.style.color = '';
                                });
                                logoText.style.color = '';

                            }
                        });
                    }
                </script>
            </label>
            <i class="fas fa-bars" id="menu-icon"></i>
        </h1>
    </div>

    <!-- nav right  -->
    <div id="myNav" class="overlay">
        <div class="overlay-side overlay-side-white"></div>
        <div class="overlay-side overlay-side-black">
            <p id="logo-timesync">Time.Sync</p>
            <button type="button" id="signup-button">Sign Up</button>
            <button type="button" id="signin-button">Sign In</button>

            <div><a href="http://example.com" target="_blank" class="my-link1">Lates News</a></div>
            <div><a href="http://example.com" target="_blank" class="my-link1">Stock Ideas</a></div>
            <div><a href="http://example.com" target="_blank" class="my-link1">Today's weather</a></div>
            <div><a href="http://example.com" target="_blank" class="my-link1">Stock Forecasts </a></div>
            <div><a href="http://example.com" target="_blank" class="my-link1">Earnings & Revenue</a></div>
            <div class="social-icons">
                <a href="https://www.facebook.com/minhlong020102" target="_blank"><i class="fab fa-facebook-f"></i></a>
                <a href="https://www.instagram.com/khoi.iag/" target="_blank"><i class="fab fa-instagram"></i></a>
                <a href="https://github.com/lonGDiBo/VARNN_MODEL_WEBSITE" target="_blank"><i
                        class="fab fa-github"></i></a>
                <a href="https://twitter.com/yourusername" target="_blank"><i class="fab fa-twitter"></i></a>
                <a href="https://www.linkedin.com/in/minhlongba/" target="_blank"><i class="fab fa-linkedin-in"></i></a>
            </div>

            <div id="ww_3e9735a04a280" v='1.3' loc='id'
                a='{"t":"ticker","lang":"en","sl_lpl":1,"ids":[],"font":"Arial","sl_ics":"one_a","sl_sot":"celsius","cl_bkg":"image","cl_font":"#FFFFFF","cl_cloud":"#FFFFFF","cl_persp":"#81D4FA","cl_sun":"#FFC107","cl_moon":"#FFC107","cl_thund":"#FF5722"}'>
                More forecasts: <a href="https://oneweather.org/london/30_days/" id="ww_3e9735a04a280_u"
                    target="_blank">Weather London 30 days</a></div>
            <script async src="https://app2.weatherwidget.org/js/?id=ww_3e9735a04a280"></script>
        </div>
    </div>
    <script>
        function toggleNav() {
            var overlay = document.getElementById("myNav");
            if (overlay.style.width === "100%") {
                overlay.style.width = "0%";
                document.body.style.overflow = 'auto';
            } else {
                overlay.style.width = "100%";
                document.body.style.overflow = 'hidden';
            }
        }
        document.getElementById("menu-icon").addEventListener("click", toggleNav);
        document.querySelector(".overlay-side.overlay-side-white").addEventListener("click", toggleNav);
    </script>

    <!-- Feed back -->
    <button id="feedback-button"><i class="fas fa-comment-dots"></i>Feedback</button>
    <label id="feedback-label" style="display: none;">
        <button id="close-label">
            <i class="fas fa-times-circle"></i>
        </button>
        <label id="text-fb">
            <div class="rating-card">
                <div class="text-wrapper">
                    <p class="text-primary">Please Rate Your Experience</p>
                    <p class="text-secondary">to help us serve you better</p>
                </div>

                <div class="rating-stars-container">
                    <input value="star-5" name="star" id="star-5" type="radio" />
                    <label for="star-5" class="star-label">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"
                                pathLength="360"></path>
                        </svg>
                    </label>
                    <input value="star-4" name="star" id="star-4" type="radio" />
                    <label for="star-4" class="star-label">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"
                                pathLength="360"></path>
                        </svg>
                    </label>
                    <input value="star-3" name="star" id="star-3" type="radio" />
                    <label for="star-3" class="star-label">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"
                                pathLength="360"></path>
                        </svg>
                    </label>
                    <input value="star-2" name="star" id="star-2" type="radio" />
                    <label for="star-2" class="star-label">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"
                                pathLength="360"></path>
                        </svg>
                    </label>
                    <input value="star-1" name="star" id="star-1" type="radio" />
                    <label for="star-1" class="star-label">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"
                                pathLength="360"></path>
                        </svg>
                    </label>
                </div>
                <div class="socials-container">
                    <p class="text-secondary"
                        style="display: block !important; font-weight: 500  !important; white-space: nowrap;">Send text
                        feedback to me via Gmail at: </p>
                    <p class="text-secondary"
                        style="user-select: all; font-size: 13px; display: flex !important; align-items: center; margin-top: -10px;">
                        <i class="fas fa-envelope" style="margin-right: 5px;"></i>
                        longpm211@gmail.com
                    </p>
                </div>
            </div>
        </label>
    </label>
    <script>
        document.getElementById("feedback-button").addEventListener("click", function () {
            this.style.display = "none";
            document.getElementById("feedback-label").style.display = "block";
        });

        document.getElementById("close-label").addEventListener("click", function (event) {
            event.stopPropagation(); // Prevents the event from bubbling up and triggering the click event on the label
            document.getElementById("feedback-label").style.display = "none";
            document.getElementById("feedback-button").style.display = "block";
        });
    </script>

    <!-- Arrow up top -->
    <button onclick="topFunction()" id="Btn-arrow-up" title="Go to top">
        <i class="fa fa-arrow-up"></i>
    </button>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#Btn-arrow-up').hide();

            $(window).scroll(function () {
                if ($(this).scrollTop() > 120) {
                    $('#Btn-arrow-up').fadeIn();
                } else {
                    $('#Btn-arrow-up').fadeOut();
                }
            });

            $('#Btn-arrow-up').click(function () {
                $("html, body").animate({ scrollTop: 0 }, 600);
                return false;
            });
        });
    </script>

    <h2 style="margin-top: 95px;">01. Select Data</h2>
    <form action="/data" method="post" enctype="multipart/form-data">
        <label for="data">Choose a dataset:</label>
        <select name="data" id="data">
            <option value="">-- Please choose a dataset-- </option>
            <option value="GOOGLE">STOCK- GOOGLE</option>
            <option value="APPLE">STOCK - APPLE</option>
            <option value="AMAZON">STOCK - AMAZON</option>
            <option value="Weather_WS">WEATHER - DUC</option>
            <option value="weather-HCM">WEATHER - HCM</option>
        </select>
        <script>document.getElementById('data').addEventListener('focus', function () {
                this.children[0].style.display = 'none';
            });</script>

        <p style="text-align: center; user-select: none;">or</p>

        <button class="container-btn-file">
            <i class="fas fa-file-csv" style="color: #fff; font-size: 20px; margin-right: 10px;"></i>
            Upload File
            <input class="file" name="text" type="file" onchange="updateFileName(this)" accept=".csv" />
        </button>
        <div id="fileName" style="color: black; text-align: center; width: 100%; font-size: 12px; user-select: none;">
        </div>

        <script>
            document.getElementById('data').addEventListener('change', function () {
                if (this.value) {
                    document.querySelector('.file').value = '';
                    document.getElementById("fileName").textContent = "";
                }
            });

            function updateFileName(inputElement) {
                var fileNameElement = document.getElementById("fileName");
                if (inputElement.files.length > 0) {
                    fileNameElement.textContent = "File uploaded successfully: " + inputElement.files[0].name;
                    document.getElementById('data').value = '';
                } else {
                    fileNameElement.textContent = "";
                }
            }
        </script>

        <input type="submit" value="Load Data" id="loadData">
    </form>

    {% if message %}
    <div id="alert-load-data-error" style=" padding: 10px;">
        <span
            style="font-weight: bold; color: rgb(231, 231, 231);  top: 50%; transform: translateY(-50%);margin-right: 5px; font-size: 15px;">
            <i class="fas fa-exclamation-circle"></i>
        </span>
        {{ message }}
        <span id="close-alert"
            style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; font-size: 25px;">&times;</span>
    </div>
    <script>
        document.getElementById('close-alert').addEventListener('click', function () {
            this.parentElement.style.opacity = '0';
            setTimeout(() => {
                this.parentElement.style.display = 'none';
            }, 10);
        });

        setTimeout(function () {
            var alertElement = document.getElementById('alert-load-data-error');
            if (alertElement) {
                alertElement.style.opacity = '0';
                setTimeout(() => {
                    alertElement.style.display = 'none';
                }, 1000);
            }
        }, 3000); 
    </script>
    {% endif %}

    {% if data_loaded %}
    <div id="alert-load-data-success" style="padding: 10px;">
        <span
            style="font-weight: bold; color: rgb(231, 231, 231); top: 50%; transform: translateY(-50%); margin-right: 5px; font-size: 15px;">
            <i class="fas fa-check-circle"></i>
        </span>
        Loading data successful
        <span id="close-alert-success"
            style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; font-size: 25px;">&times;</span>
    </div>
    <script>
        document.getElementById('close-alert-success').addEventListener('click', function () {
            this.parentElement.style.opacity = '0';
            setTimeout(() => {
                this.parentElement.style.display = 'none';
            }, 10);
        });

        setTimeout(function () {
            var alertElement = document.getElementById('alert-load-data-success');
            if (alertElement) {
                alertElement.style.opacity = '0';
                setTimeout(() => {
                    alertElement.style.display = 'none';
                }, 1000);
            }
        }, 3000); 
    </script>
    {% endif %}


    {% if data %}
    <h2>02. Data overview: {{global_name}}</h2>
    <form action="">
        <div style="margin-bottom: 10px;font-family: 'Montserrat', sans-serif; user-select: none;"><i
                class="fas fa-play" style="color: rgb(0, 140, 255); margin-right: 10px;"></i> Number of
            observations:
            {{count_data}}</div>
        <div style="margin-top: 30px; font-family: 'Montserrat', sans-serif; user-select: none;"><i class="fas fa-play"
                style="color: rgb(0, 140, 255); margin-right: 10px;"></i>
            Number of columns: {{num_columns}} | {{columns}}</div>
        <table id="data-table">
            {{ data | safe }}
        </table>
    </form>


    <h2>03. EDA - Exploratory Data Analysis <i id="toggle-form" class="material-symbols-outlined"
            style="color: #3652AD; cursor: pointer; margin-left: 15px;">visibility</i>
    </h2>
    <form id="eda-form" method="POST" action="/eda_column" style="display: none;">
        <p style="font-family: 'Montserrat', sans-serif; user-select: none;" id="selected-column">Select the column:
        </p>
        <select id="column-input" name="column">
            <option value="">-- Please choose a column --</option>
            {% for column in columns %}
            <option value="{{ column }}">{{ column }}</option>
            {% endfor %}
        </select>
        <script>
            document.getElementById('column-input').addEventListener('focus', function () {
                this.children[0].style.display = 'none';
                for (var i = 0; i < this.children.length; i++) {
                    var child = this.children[i];
                    if (child.value === 'date' || child.value === 'Date' || child.value === 'Date Time') {
                        child.style.display = 'none';
                    }
                }
            });
        </script>
        <input id="visualize-button" type="submit" value="Visualize as Line Graph">
        <div class="image-container">
            <img id="plot" src="static/images/Loading-Spinner.gif" alt="Plot">
        </div>

    </form>
    <script>
        document.getElementById('toggle-form').addEventListener('click', function () {
            var form = document.getElementById('eda-form');
            var icon = this;
            if (form.style.display === "none") {
                form.style.display = "block";
                icon.textContent = 'visibility_off'; // Change the icon to 'visibility_off'
                icon.style.color = "#332941";

            } else {
                form.style.display = "none";
                icon.textContent = 'visibility'; // Change the icon to 'visibility'
                icon.style.color = "#3652AD";

            }
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-elevatezoom/3.0.8/jquery.elevatezoom.min.js"></script>
    <div id="alert-eda-data-success" style="padding: 10px; display:none;">
        <span
            style="font-weight: bold; color: rgb(231, 231, 231); top: 50%; transform: translateY(-50%); margin-right: 5px; font-size: 15px;">
            <i class="fas fa-check-circle"></i>
        </span>
        Successful visualization
        <span id="close-alert-success"
            style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; font-size: 25px;">&times;</span>
    </div>
    <script>
        $(document).ready(function () {
            $("#eda-form").submit(function (e) {
                e.preventDefault();
                var column = $("#column-input").val();
                console.log('ten cot:', column);
                $.post("/eda_column", { column: column }, function (data) {

                    $("#selected-column").text("You have selected column name: " + data.column_name);
                    $("#plot").attr("src", "/static/images/plot.png?" + new Date().getTime());

                    var alertElement = document.getElementById('alert-eda-data-success');
                    if (alertElement) {
                        alertElement.style.display = 'block';
                        alertElement.style.opacity = '1';
                        setTimeout(function () {
                            alertElement.style.opacity = '0';
                            setTimeout(() => {
                                alertElement.style.display = 'none';
                            }, 1000);
                        }, 3000);
                    }
                });
            });
        });
    </script>

    <h2>04. Time series prediction</h2>
    <form class="container-form-predict">

        <div class="selection-predict">

            <label style="padding-left: 46px; padding-right: 27px;" for="algorithm">Choose a column:</label>

            <select id="column_prediction" name="column1">
                <option value="">-- Please choose a column for predict --</option>
                {%if global_name == "GOOGLE" or global_name == "APPLE" or global_name == "AMAZON" or global_name ==
                "Weather_WS" or global_name == "weather-HCM"%}
                {% for column in columns %}
                <option value="{{ column }}">{{ column }}</option>
                <script>
                    document.getElementById('column_prediction').addEventListener('focus', function () {
                        this.children[0].style.display = 'none';
                        for (var i = 0; i < this.children.length; i++) {
                            var child = this.children[i];
                            // if (child.value === 'date' || child.value === 'Volume' || child.value === 'Date' || child.value === 'wind_d' || child.value === 'Date Time' || child.value === 'Adj Close') {
                            if (child.value === 'date' || child.value === 'Volume' || child.value === 'Date' || child.value === 'wind_d' || child.value === 'Date Time') {
                                child.style.display = 'none';
                            }
                        }
                    });
                </script>
                {% endfor %}
                {%else%}
                {% for column in output_columns %}
                <option value="{{ column }}">{{ column }}</option>
                <script>
                    document.getElementById('column_prediction').addEventListener('focus', function () {
                        this.children[0].style.display = 'none';
                    });
                </script>
                {% endfor %}
                {%endif%}
            </select>
            <div style="color: black; text-align: center; width: 100%; font-size: 12px; user-select: none;">
                "If the column you want to predict is missing, please review its data and format"
            </div>
            <div id="algorithm-selection" style="margin-bottom: 15px;">
                <label style="padding-left: 46px;" for="algorithm">Choose an algorithm:</label>
                <select id="algorithm" name="algorithm">
                    <option value="">-- Please choose an algorithm --</option>
                    <option value="algorithm-varnn">VARNN</option>
                    <option value="algorithm-ffnn">FFNN</option>
                    <option value="algorithm-lstm">LSTM</option>
                    <option value="algorithm-var">VAR</option>
                    <option value="algorithm-arima">ARIMA</option>
                </select>
            </div>
            <!-- Open the alogrithm when you selected the column for predict -->
            <script>
                var columnSelect = document.getElementById('column_prediction');
                var algorithmSelect = document.getElementById('algorithm');
                algorithmSelect.disabled = true;
                columnSelect.addEventListener('change', function () {
                    if (this.value !== '') {
                        algorithmSelect.disabled = false;
                    } else {
                        algorithmSelect.disabled = true;
                    }
                });
            </script>
            <!-- Hide title selectbox -->
            <script>
                document.getElementById('algorithm').addEventListener('focus', function () {
                    this.children[0].style.display = 'none';
                });
            </script>
            <div id="checkboxparam" style="display: none;">
                <input type="checkbox" id="useExistingModel" name="useExistingModel" style="margin-left: 43px;">
                <label style="font-size: 14px;" for="useExistingModel">Applying a pre-optimized parameter model</label>
            </div>
            <span id='or_predict' style=" display: none ;margin-left: 70px; margin-top: 10px; user-select: none;">or
            </span>

            <div id="getcolumnoutput" style="display: none; align-items: center; margin-bottom: 10px;">
                <label style="padding-left: 46px; padding-right: 5px;">Pick output columns:</label>
                <div class="customCheckBoxHolder">
                    {%if global_name == "GOOGLE" or global_name == "APPLE" or global_name == "AMAZON" or global_name ==
                    "Weather_WS" or global_name == "weather-HCM"%}
                    {% for column in columns %}
                    {% if column != 'Date' and column !='date' and column != 'Date Time' and column != 'wind_d' %}
                    <input class="customCheckBoxInput" id="cCB{{ column }}" type="checkbox" value="{{ column }}"
                        onchange="submitColumns()">
                    <label class="customCheckBoxWrapper" for="cCB{{ column }}">
                        <div class="customCheckBox">
                            <div class="inner">{{ column }}</div>
                        </div>
                    </label>
                    {% endif %}
                    {% endfor %}
                    {%else%}
                    {% for column in output_columns %}
                    <input class="customCheckBoxInput" id="cCB{{ column }}" type="checkbox" value="{{ column }}"
                        onchange="submitColumns()">
                    <label class="customCheckBoxWrapper" for="cCB{{ column }}">
                        <div class="customCheckBox">
                            <div class="inner">{{ column }}</div>
                        </div>
                    </label>
                    {% endfor %}
                    {%endif%}
                </div>
            </div>
            <!-- If the selected column is predicted, it will be selected by default -->
            <script>
                var currentPredictedColumn = null;

                document.getElementById('column_prediction').addEventListener('change', function () {
                    var selectedColumn = this.options[this.selectedIndex].value;

                    if (currentPredictedColumn) {
                        var oldCheckbox = document.getElementById('cCB' + currentPredictedColumn);
                        oldCheckbox.disabled = false;
                    }

                    var checkbox = document.getElementById('cCB' + selectedColumn);
                    checkbox.checked = true;
                    checkbox.disabled = true;

                    currentPredictedColumn = selectedColumn;
                });
            </script>
            <!-- Get output columns -->
            <script>
                function submitColumns() {
                    let selectedColumns = [];
                    document.querySelectorAll('.customCheckBoxInput:checked').forEach((checkbox) => {
                        selectedColumns.push(checkbox.value);
                    });
                    fetch('/getcolumn_ouput_multi', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(selectedColumns),
                    })
                        .then(response => response.json())
                        .then(data => console.log(data))
                        .catch((error) => {
                            console.error('Error:', error);
                        });
                }
            </script>

            <span class="adjust-parameter"
                style="user-select: none; padding-left: 46px; display: none; text-decoration: underline; cursor: pointer; font-size: 14px;color: #3652AD; margin-top: 5px;"
                onclick="toggleLabel()">Configure options</span>
            <!-- Custome Adjust Param  -->
            <script>
                document.getElementById('algorithm').addEventListener('change', function () {
                    var configOptionsSpan = document.querySelector('.adjust-parameter');
                    var checkboxUseParam = document.getElementById('checkboxparam');
                    var getalgorithm = document.getElementById('algorithm');
                    var outputcolumn = document.getElementById('getcolumnoutput');
                    var or_predict = document.getElementById('or_predict');
                    var dataset = globalName;
                    if (dataset == "AMAZON" || dataset == "APPLE" || dataset == "GOOGLE" || dataset == "Weather_WS" || dataset == "weather-HCM") {
                        if (this.value !== '') {
                            if (getalgorithm.value == 'algorithm-lstm' || getalgorithm.value == 'algorithm-varnn' || getalgorithm.value == 'algorithm-var') {
                                outputcolumn.style.display = 'block';
                                configOptionsSpan.style.display = 'block';
                                checkboxUseParam.style.display = 'block';
                                or_predict.style.display = 'block';
                            }
                            else {
                                outputcolumn.style.display = 'none';
                                configOptionsSpan.style.display = 'block';
                                checkboxUseParam.style.display = 'block';
                                or_predict.style.display = 'block';
                            }
                        } else {
                            outputcolumn.style.display = 'none';
                            configOptionsSpan.style.display = 'none';
                            checkboxUseParam.style.display = 'none';
                            or_predict.style.display = 'none';
                        }
                    }
                    else {
                        if (getalgorithm.value == 'algorithm-lstm' || getalgorithm.value == 'algorithm-varnn' || getalgorithm.value == 'algorithm-var') {
                            configOptionsSpan.style.display = 'block';
                            outputcolumn.style.display = 'block';
                            or_predict.style.display = 'none';
                            checkboxUseParam.style.display = 'none';
                        }
                        else {
                            configOptionsSpan.style.display = 'block';
                            outputcolumn.style.display = 'none';
                            or_predict.style.display = 'none';
                            checkboxUseParam.style.display = 'none';
                        }
                    }
                });
            </script>
            <!-- Add Modal adjust param -->
            <div id="myModal" class="modal">
                <div class="modal-content">
                    <div class="header-adjust">
                        <span class="close">&times;</span>
                        <label id="parameter_title">Configure Options</label>
                    </div>

                    <div class="container-choosepara">
                        <div class="item left">
                            <div id="split-selection" style="display: flex; align-items: center;">
                                <select id="split" name="splitdata" style="width: 200px; height: 45px;">
                                    <option value="">Choose a data splitting</option>
                                    <option value="split82">8/2</option>
                                    <option value="split73">7/3</option>
                                </select>
                                <script>
                                    document.getElementById('split').addEventListener('focus', function () {
                                        this.children[0].style.display = 'none';
                                    });
                                </script>
                            </div>
                        </div>
                        <div class="item right">
                        </div>
                    </div>
                    <div class="button-container" style="display: flex;">
                        <button id="resetButton" type="button">Reset</button>
                        <button id="saveButton" type="button">Save</button>
                    </div>
                </div>
            </div>
            <!-- Event Open and Close MyModal -->
            <script>
                var modal = document.getElementById("myModal");
                var span = document.getElementsByClassName("close")[0];

                function toggleLabel() {
                    if (modal.style.display === "none" || modal.style.display === "") {
                        modal.style.display = "block";
                        document.body.style.overflow = 'hidden';
                    } else {
                        modal.style.display = "none";
                        document.body.style.overflow = 'auto';
                    }
                }

                span.onclick = function () {
                    modal.style.display = "none";
                    document.body.style.overflow = 'auto';
                }

                window.onclick = function (event) {
                    if (event.target == modal) {
                        modal.style.display = "none";
                        document.body.style.overflow = 'auto';
                    }
                }
            </script>
            <!-- Get global name dataset -->
            <script>
                var globalName = "{{ global_name }}";
            </script>
            <!-- Add input group -->
            <script>
                document.getElementById('algorithm').addEventListener('change', function () {
                    var algorithm = this.value;
                    var dataset = globalName  // Get the selected dataset
                    var column = document.getElementById('column_prediction').value;  // Get the selected column
                    if (algorithm !== '') {
                        updateModalParameters(dataset, column, algorithm);
                    }
                    console.log(dataset, column, algorithm);
                });


                function updateModalParameters(dataset, column, algorithm) {
                    var parameters;
                    if (algorithmParameters[dataset] && algorithmParameters[dataset][column]) {
                        parameters = algorithmParameters[dataset][column][algorithm];
                    } else {
                        parameters = defaultParameters[algorithm];  // Use default parameters for the algorithm
                    }
                    var algorithmDropdown = document.getElementById('split');
                    algorithmDropdown.selectedIndex = 0;

                    var modal = document.getElementById('myModal');
                    var leftContainer = modal.querySelector('.container-choosepara .item.left');
                    var rightContainer = modal.querySelector('.container-choosepara .item.right');

                    var half = Math.ceil(parameters.length / 2);
                    [leftContainer, rightContainer].forEach(function (container) {
                        container.querySelectorAll('.input-group').forEach(function (inputGroup) {
                            inputGroup.remove();
                        });
                    });
                    for (var i = 0; i < Math.min(2, parameters.length); i++) {
                        var inputGroup = createInputGroup(parameters[i]);
                        if (parameters.length === 1) {
                            rightContainer.appendChild(inputGroup);
                        } else {
                            leftContainer.appendChild(inputGroup);
                        }
                    }

                    for (var i = 2; i < parameters.length; i++) {
                        var inputGroup = createInputGroup(parameters[i]);
                        rightContainer.appendChild(inputGroup);
                    }
                }

                var inputCount = 0;
                function createInputGroup(parameter) {
                    var inputGroup = document.createElement('div');
                    inputGroup.className = 'input-group';

                    var input = document.createElement('input');
                    input.required = true;
                    input.type = 'text';
                    input.name = parameter.replace(/[\s\(\)\{\}\[\]]+/g, '_');
                    input.autocomplete = 'off';
                    input.className = 'input-para';
                    input.title = 'Only numbers are allowed';
                    input.addEventListener('input', function () {
                        this.value = this.value.replace(/\D/g, '');
                    });
                    inputGroup.appendChild(input);


                    var label = document.createElement('label');
                    label.className = 'user-label';
                    label.textContent = parameter;
                    inputGroup.appendChild(label);
                    return inputGroup;
                }
            </script>
            <!-- Reset Button -->
            <script>
                document.getElementById('resetButton').addEventListener('click', function () {
                    var inputGroups = document.getElementsByClassName('input-group');
                    for (var i = 0; i < inputGroups.length; i++) {
                        var inputs = inputGroups[i].getElementsByTagName('input');

                        for (var j = 0; j < inputs.length; j++) {
                            if (inputs[j].type === 'text') {
                                inputs[j].value = '';
                            }
                        }
                    }
                    var select = document.getElementById('split');
                    select.selectedIndex = 0;
                });
            </script>
            <!-- Save button -->
            <script>
                document.getElementById('saveButton').addEventListener('click', function () {
                    var parameters = {};

                    var splitSelection = document.getElementById('split');
                    parameters[splitSelection.name] = splitSelection.value;
                    if (splitSelection.value === '') {
                        var alertElement = document.getElementById('alert-save-param-failed');
                        if (alertElement) {
                            alertElement.style.display = 'block';
                            alertElement.style.opacity = '1';
                            setTimeout(function () {
                                alertElement.style.opacity = '0';
                                setTimeout(() => {
                                    alertElement.style.display = 'none';
                                }, 1000);
                            }, 3000);
                        }
                        return;
                    }
                    var inputs = document.querySelectorAll('.input-para');
                    for (var i = 0; i < inputs.length; i++) {
                        if (inputs[i].value === '') {
                            var alertElement = document.getElementById('alert-save-param-failed');
                            if (alertElement) {
                                alertElement.style.display = 'block';
                                alertElement.style.opacity = '1';
                                setTimeout(function () {
                                    alertElement.style.opacity = '0';
                                    setTimeout(() => {
                                        alertElement.style.display = 'none';
                                    }, 1000);
                                }, 3000);
                            }
                            return;
                        }

                        parameters[inputs[i].name] = inputs[i].value;
                    }

                    fetch('/save_parameters', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(parameters),
                    })
                        .then(response => response.json())
                        .then(data => {
                            document.getElementById('myModal').style.display = 'none';
                            document.body.style.overflow = 'auto';

                            var alertElement = document.getElementById('alert-save-param-success');
                            if (alertElement) {
                                alertElement.style.display = 'block';
                                alertElement.style.opacity = '1';
                                setTimeout(function () {
                                    alertElement.style.opacity = '0';
                                    setTimeout(() => {
                                        alertElement.style.display = 'none';
                                    }, 1000);
                                }, 3000);
                            }

                        })
                        .catch((error) => {
                            console.error('Error:', error);
                        });
                });
            </script>
            <!-- Alert Save Param Success -->
            <div id="alert-save-param-success" style="padding: 10px; display:none">
                <span
                    style="font-weight: bold; color: rgb(231, 231, 231); top: 50%; transform: translateY(-50%); margin-right: 5px; font-size: 15px;">
                    <i class="fas fa-check-circle"></i>
                </span>
                Model parameters saved
                <span id="close-alert-save-param-success"
                    style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; font-size: 25px;">&times;</span>
            </div>
            <!-- Alert save param Failed -->
            <div id="alert-save-param-failed" style="padding: 10px; display:none">
                <span
                    style="font-weight: bold; color: rgb(231, 231, 231); top: 50%; transform: translateY(-50%); margin-right: 5px; font-size: 15px;">
                    <i class="fas fa-check-circle"></i>
                </span>
                Please fill all the fields
                <span id="close-alert-save-param-failed"
                    style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer; font-size: 25px;">&times;</span>
            </div>
            <!-- Close Alert Failed and success when you save param -->
            <script>
                document.getElementById('close-alert-save-param-success').addEventListener('click', function () {
                    this.parentElement.style.opacity = '0';
                    setTimeout(() => {
                        this.parentElement.style.display = 'none';
                    }, 10);
                });

                document.getElementById('close-alert-save-param-failed').addEventListener('click', function () {
                    this.parentElement.style.opacity = '0';
                    setTimeout(() => {
                        this.parentElement.style.display = 'none';
                    }, 10);
                });
            </script>
            <div style="padding-left: 45px;margin-right: 50px;">
                <input type="submit" value="Predict" id="PredictData">
            </div>
            <div id="predictionStatus"
                style=" display:None; color: black; text-align: center; width: 100%; font-size: 13px; user-select: none; margin-top: 10px; margin-bottom: 10px">
            </div>
            <div id="infor_predict" style="display: none;">
                <div id="checkboxrealvalue">
                    <input type="checkbox" id="showRealValue" name="showRealValue">
                    <label for="showRealValue">Show by real value</label>
                </div>
                <div id="timeContainer" style="display: flex;margin-left: auto;margin-right: auto;user-select: none;">
                    <div id="timetraincontainer" style="display: flex; margin-left: 30px;">
                        <p id="timetrain">Time train: </p>
                        <p id="timetrainDisplay" style=" margin-left: 5px;"></p>
                    </div>
                    <div id=" timetestcontainer" style="margin-left: 20px; display: flex;">
                        <p id="timetest">Time predict: </p>
                        <p id="timetestDisplay" style="margin-left: 5px;"></p>
                    </div>
                </div>
                <div id="mseContainer" style="display: flex; ">
                    <div id="dodo">
                        <p id="mse">MSE: </p>
                    </div>
                    <p id="mseDisplay"></p>
                </div>

                <div id="rmseContainer" style="display: flex; ">
                    <div id="dodo">
                        <p id="rmse">RMSE: </p>
                    </div>
                    <p id="rmseDisplay"></p>
                </div>

                <div id="maeContainer" style="display: flex; ">
                    <div id="dodo">
                        <p id="mae">MAE: </p>
                    </div>
                    <p id="maeDisplay"></p>
                </div>
                <button id="viewParameters" type="button">View model parameters</button>
                <div id="modelParameters" style="display: none;">

                    <div id="SplitHiddenlayer" style="display: none ">
                        <div id="splitcontainer" style="display: flex;">
                            <div id="dodo1">
                                <p id="splitdata">Split data:</p>
                            </div>
                            <p id="splitDisplay"></p>
                        </div>
                        <div id="hiddenlayercontainer" style="display: flex;">
                            <div id="dodo1">
                                <p id="hiddenlayer">Layers:</p>
                            </div>
                            <p id="hiddenlayerDisplay"></p>
                        </div>
                    </div>

                    <div id="EpochBatchSize" style="display: none ">
                        <div id="epochcontainer" style="display: flex;">
                            <div id="dodo1">
                                <p id="epoch">Epoch:</p>
                            </div>
                            <p id="epochDisplay"></p>
                        </div>
                        <div id="batchsizecontainer" style="display: flex;">
                            <div id="dodo1">
                                <p id="batchsize">Batch Size:</p>
                            </div>
                            <p id="batchsizeDisplay"></p>
                        </div>
                    </div>

                    <div id="neuronWindowsize" style="display: none ">
                        <div id="epochcontainer" style="display: flex;">
                            <div id="dodo1">
                                <p id="neuron">Neurons:</p>
                            </div>
                            <p id="neuronDisplay"></p>
                        </div>
                        <div id="windowsizecontainer" style="display: flex;">
                            <div id="dodo1">
                                <p id="windowsize">Window size: </p>
                            </div>
                            <p id="windowsizeDisplay" style="margin-left: 5px;"></p>
                        </div>
                    </div>
                    <div id="lagOrderContainer" style="display: none;">
                        <div id="splitvarcontainer" style="display: flex;">
                            <div id="dodolag">
                                <p id="splitdatavar">Split data:</p>
                            </div>
                            <p id="splitvarDisplay"></p>
                        </div>
                        <div id="ordercontainer" style="display: flex;">
                            <div id="dodolag">
                                <p id="orderlag">Order of lags:</p>
                            </div>
                            <p id="orderDisplay" style="margin-left: 5px;"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Chart predict -->
        <div class=" chart">
            <img id="plot-predict" src="static/images/Loading-Spinner.gif" alt="Plot">
        </div>
    </form>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        var isRealValueShown = false;
        var predictionData = null;

        $(document).ready(function () {
            $('#PredictData').click(function (e) {
                e.preventDefault(); // Prevent the form from being submitted normally

                var algorithm = document.getElementById('algorithm').value; // Get the selected algorithm
                var column_prediction = document.getElementById('column_prediction').value; // Get the selected column
                var useExistingModel = document.getElementById('useExistingModel').checked ? 'on' : 'off';
                document.getElementById('infor_predict').style.display = 'none';
                $("#plot-predict").attr("src", "static/images/Loading-Spinner.gif");
                document.getElementById('modelParameters').style.display = 'none';
                // Show the prediction status and update its text
                var predictionStatus = document.getElementById('predictionStatus');
                predictionStatus.style.display = 'block';
                predictionStatus.textContent = ' Currently in the process of predicting...';
                $.ajax({
                    url: '/model',
                    method: 'POST',
                    data: {
                        'algorithm': algorithm,
                        'column_prediction': column_prediction,
                        'useExistingModel': useExistingModel
                    },
                    success: function (data) {
                        console.log('Algorithm:', data.algorithm);
                        console.log('Column prediction:', data.column_prediction);
                        predictionStatus.textContent = 'Successfully predicted...';
                        document.getElementById('infor_predict').style.display = 'block';
                        predictionData = data;
                        updatePredictionDisplay();
                        if (data.algorithm == 'algorithm-lstm' || data.algorithm == 'algorithm-ffnn')
                            displayparam_ffnn();
                        if (data.algorithm == 'algorithm-var')
                            displayparam_var();
                        $("#plot-predict").attr("src", "/static/images/plot_predict.png?" + new Date().getTime());

                    },
                    error: function (error) {
                        console.error('Error:', error);
                        var errorMessage = error.responseJSON && error.responseJSON.error
                            ? error.responseJSON.error
                            : 'Failed to predict...';
                        predictionStatus.textContent = errorMessage;
                    }
                });
            });

            $('#showRealValue').click(function () {
                isRealValueShown = !isRealValueShown;
                updatePredictionDisplay();
            });
            $('#viewParameters').click(function () {
                var modelParameters = document.getElementById('modelParameters');
                if (modelParameters.style.display === 'none') {
                    modelParameters.style.display = 'block';
                } else {
                    modelParameters.style.display = 'none';
                }
            });
        });
        function displayparam_ffnn() {
            var epoch = document.getElementById('epochDisplay');
            var batchsize = document.getElementById('batchsizeDisplay');
            var hiddenlayer = document.getElementById('hiddenlayerDisplay');
            var split = document.getElementById('splitDisplay');
            var neuron = document.getElementById('neuronDisplay');
            var windowsize = document.getElementById('windowsizeDisplay');
            document.getElementById('EpochBatchSize').style.display = 'flex';
            epoch.textContent = predictionData.epochs;
            batchsize.textContent = predictionData.batch_sizes;
            document.getElementById('SplitHiddenlayer').style.display = 'flex';
            hiddenlayer.textContent = predictionData.hidden_layers;
            split.textContent = predictionData.split_ratio;
            document.getElementById('neuronWindowsize').style.display = 'flex';
            neuron.textContent = predictionData.hidden_neurons;
            windowsize.textContent = predictionData.seq_size;

            var time_train = document.getElementById('timetrainDisplay');
            var time_test = document.getElementById('timetestDisplay');
            time_train.textContent = predictionData.time_train + ' (s)';
            time_test.textContent = predictionData.time_predict + ' (s)';
        }
        function displayparam_var() {
            var orderlag = document.getElementById('orderDisplay');
            var splitvar = document.getElementById('splitvarDisplay');
            document.getElementById('lagOrderContainer').style.display = 'flex';
            orderlag.textContent = predictionData.p;
            splitvar.textContent = predictionData.split_ratio;
            var time_train = document.getElementById('timetrainDisplay');
            var time_test = document.getElementById('timetestDisplay');
            time_train.textContent = predictionData.time_train + ' (s)';
            time_test.textContent = predictionData.time_predict + ' (s)';
        }

        function updatePredictionDisplay() {
            var mseDisplay = document.getElementById('mseDisplay');
            var rmseDisplay = document.getElementById('rmseDisplay');
            var maeDisplay = document.getElementById('maeDisplay');

            if (isRealValueShown) {
                mseDisplay.textContent = predictionData.testScore_mse_real;
                rmseDisplay.textContent = predictionData.testScore_rmse_real;
                maeDisplay.textContent = predictionData.testScore_mae_real;

            } else {
                mseDisplay.textContent = predictionData.testScore_mse;
                rmseDisplay.textContent = predictionData.testScore_rmse;
                maeDisplay.textContent = predictionData.testScore_mae;
            }
        }
    </script>


    {% endif %} <!-- Kt thc ca if load d liu  -->
    {% include 'footer.html' %}
    {% if data %}
    <script>
        $('.footer-distributed').css('margin-top', '50px');
    </script>
    {% endif %}
</body>

</html>